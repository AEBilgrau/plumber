version: '2'
services:
  append: 
    build: ../examples/01-append/
    volumes:
     - ../examples:/examples
    restart: always
  filters: 
    build: ../examples/02-filters/
    volumes:
     - ../examples:/examples
    restart: always
  github: 
    build: ../examples/03-github/
    volumes:
     - ../examples:/examples
    restart: always
  sessions:
    build: ../examples/06-sessions/
    volumes:
     - ../examples:/examples
    restart: always
  mailgun:
    build: ../examples/07-mailgun/
    volumes:
     - ../examples:/examples
    restart: always
  identity:
    build: ../examples/08-identity
    volumes:
     - ../examples:/examples
    restart: always
  lb:
    image: 'dockercloud/haproxy:1.2.1'
    links:
     - identity
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
  nginx:
    image: nginx:1.9
    ports:
     - "80:80"
    volumes:
     - ./nginx.conf:/etc/nginx/nginx.conf:ro
    restart: always
    depends_on:
     - append
     - sessions
     - mailgun
     - filters
